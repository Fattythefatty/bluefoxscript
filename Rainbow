local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/thunderisdead/bluefoxscript/main/background"))()
Window = Library.Main("Bluefox Script","RightShift")
_G.Rainbowwings = false
local Tab = Window.NewTab("Settings")
local Section = Tab.NewSection("Stuff")


_G.move = {
    dmd = 15,
}

local timergb, RBW_COL = _G.move.dmd

local function updateRainbowColor()
    local hue = tick() % timergb / timergb
    if hue == 0 then
        -- Generate random RGB components when the hue is zero (black)
        RBW_COL = Color3.new(math.random(), math.random(), math.random())
    else
        RBW_COL = Color3.fromHSV(hue, 1, 1)
    end
end

local rgb1 = nil
local isRainbowEffectOn = false
local isManualColorSet = false
local currentSpeedSetting = "set" -- "set" or "random"
local targetSpeed = _G.move.dmd -- Store the target speed

local isBlackToWhiteMode = false
local currentBlackToWhiteModeColor = 0
local blackToWhiteStep = 0.01

local isCustomColorMode = false
local fromColor = Color3.new(1, 0, 0) -- Red color
local toColor = Color3.new(0, 1, 0) -- Green color
local customColorStep = 0
local customSpeed = _G.move.dmd

local customColors = {
    Color3.new(1, 0, 0), -- Red
    Color3.new(0, 1, 0), -- Green
    Color3.new(0, 0, 1), -- Blue
    Color3.new(1, 1, 0), -- Yellow
    Color3.new(1, 0, 1), -- Magenta
    Color3.new(0, 1, 1)  -- Cyan
}

local customColorIndex = 1
local customColorTransitionTime = 5 -- seconds for each color transition

local function startRainbowEffect()
    if not isManualColorSet and not isRainbowEffectOn then
        rgb1 = game:GetService('RunService').Heartbeat:Connect(function()
            if isBlackToWhiteMode then
                currentBlackToWhiteModeColor = currentBlackToWhiteModeColor + blackToWhiteStep
                if currentBlackToWhiteModeColor >= 1 then
                    currentBlackToWhiteModeColor = 1
                    blackToWhiteStep = -blackToWhiteStep
                elseif currentBlackToWhiteModeColor <= 0 then
                    currentBlackToWhiteModeColor = 0
                    blackToWhiteStep = -blackToWhiteStep
                end
                RBW_COL = Color3.new(currentBlackToWhiteModeColor, currentBlackToWhiteModeColor, currentBlackToWhiteModeColor)
            elseif isCustomColorMode then
                customColorStep = customColorStep + (1 / customSpeed)
                if customColorStep >= 1 then
                    customColorStep = 0
                    customColorIndex = customColorIndex + 1
                    if customColorIndex > #customColors then
                        customColorIndex = 1
                    end
                end
                local currentCustomColor = customColors[customColorIndex]
                local nextCustomColor = customColors[customColorIndex % #customColors + 1]
                local stepColor = Color3.new(
                    currentCustomColor.r + (nextCustomColor.r - currentCustomColor.r) * customColorStep,
                    currentCustomColor.g + (nextCustomColor.g - currentCustomColor.g) * customColorStep,
                    currentCustomColor.b + (nextCustomColor.b - currentCustomColor.b) * customColorStep
                )
                RBW_COL = stepColor
            else
                updateRainbowColor()
            end
        end)
        isRainbowEffectOn = true
    end
end

local function stopRainbowEffect()
    if isRainbowEffectOn then
        if rgb1 then
            rgb1:Disconnect()
            rgb1 = nil
        end
        isRainbowEffectOn = false
    end
end

local function smoothChangeSpeed(newSpeed)
    local currentSpeed = _G.move.dmd
    local timeToChange = 1.5 -- Transition time in seconds
    local steps = 60 -- Number of steps in the transition

    for i = 1, steps do
        local stepSpeed = currentSpeed + (newSpeed - currentSpeed) * (i / steps)
        _G.move.dmd = stepSpeed
        customSpeed = stepSpeed
        timergb = stepSpeed
        wait(timeToChange / steps)
    end

    _G.move.dmd = newSpeed
    customSpeed = newSpeed
    timergb = newSpeed
end

local function smoothChangeColor(newRed, newGreen, newBlue)
    local currentColor = RBW_COL
    local timeToChange = 1.5 -- Transition time in seconds
    local steps = 60 -- Number of steps in the transition

    for i = 1, steps do
        local stepColor = Color3.new(
            currentColor.r + (newRed - currentColor.r) * (i / steps),
            currentColor.g + (newGreen - currentColor.g) * (i / steps),
            currentColor.b + (newBlue - currentColor.b) * (i / steps)
        )
        RBW_COL = stepColor
        wait(timeToChange / steps)
    end

    RBW_COL = Color3.new(newRed, newGreen, newBlue)
end

local speedChangeInterval = 5

local function randomizeRainbowSpeed()
    local seedGenerator = Random.new(tick())
    while true do
        if _G.randomSpeed and isRainbowEffectOn and currentSpeedSetting == "random" then
            local newSpeed = seedGenerator:NextInteger(1, 30)
            smoothChangeSpeed(newSpeed)
        end
        wait(speedChangeInterval) -- Wait for the specified interval before the next speed change
    end
end

Section.NewToggle("Rainbow Toggle", function(bool)
    _G.rainbow = bool
    if _G.rainbow then
        startRainbowEffect()
    else
        stopRainbowEffect()
    end
end)

local randomSpeedToggle = Section.NewToggle("Random Speed", function(bool)
    _G.randomSpeed = bool
    if bool then
        currentSpeedSetting = "random"
        stopRainbowEffect()
        startRainbowEffect()
    else
        currentSpeedSetting = "set"
        local newSpeed = tonumber(Section.GetText('Rainbow Speed'))
        if newSpeed then
            targetSpeed = newSpeed -- Update the target speed
            smoothChangeSpeed(targetSpeed) -- Use smooth change
            stopRainbowEffect()
            startRainbowEffect()
        end
    end
end)

Section.Newtextbox('Rainbow Speed', function(self, value)
    if tonumber(value) then
        local speed = tonumber(value)

        if not _G.randomSpeed then
            targetSpeed = speed -- Update
            smoothChangeSpeed(targetSpeed) -- Use smooth change
        end

        if _G.rainbow then
            stopRainbowEffect()
            startRainbowEffect()
        end
    end
end)

local redComponent = 255
local greenComponent = 0
local blueComponent = 0

local function setManualColor()
    if isManualColorSet then
        smoothChangeColor(redComponent / 255, greenComponent / 255, blueComponent / 255)
    end
end

local redTextbox = Section.Newtextbox('Red Component (0-255)', function(self, value)
    if tonumber(value) then
        redComponent = math.clamp(tonumber(value), 0, 255)
        if isManualColorSet then
            setManualColor()
        end
    end
end)

local greenTextbox = Section.Newtextbox('Green Component (0-255)', function(self, value)
    if tonumber(value) then
        greenComponent = math.clamp(tonumber(value), 0, 255)
        if isManualColorSet then
            setManualColor()
        end
    end
end)

local blueTextbox = Section.Newtextbox('Blue Component (0-255)', function(self, value)
    if tonumber(value) then
        blueComponent = math.clamp(tonumber(value), 0, 255)
        if isManualColorSet then
            setManualColor()
        end
    end
end)

local intervalTextbox = Section.Newtextbox('Speed Change Interval (seconds)', function(self, value)
    if tonumber(value) then
        speedChangeInterval = math.clamp(tonumber(value), 1, 50)
    end
end)

local customSpeedTextbox = Section.Newtextbox('Custom Speed (1-300)', function(self, value)
    if tonumber(value) then
        local speed = math.clamp(tonumber(value), 1, 300)
        _G.move.dmd = speed
        customSpeed = speed
        timergb = speed
        if _G.randomSpeed then
            stopRainbowEffect()
            startRainbowEffect()
        end
    end
end)

local customColorToggle = Section.NewToggle("Custom Color Mode", function(bool)
    if bool then
        isCustomColorMode = true
        customColorStep = 0
        stopRainbowEffect()
        RBW_COL = fromColor
        wait(0.5) -- Wait for a moment before starting the transition
        startRainbowEffect()
    else
        isCustomColorMode = false
        startRainbowEffect()
    end
end)

local blackToWhiteToggle = Section.NewToggle("Black to White Mode", function(bool)
    if bool then
        isBlackToWhiteMode = true
        stopRainbowEffect()
        currentBlackToWhiteModeColor = 0
        RBW_COL = Color3.new(0, 0, 0)
        wait(0.5) -- Wait for a moment before starting the transition
        startRainbowEffect()
    else
        isBlackToWhiteMode = false
        startRainbowEffect()
    end
end)

local fromColorTextbox = Section.Newtextbox('From Color (R,G,B)', function(self, value)
    local components = {}
    for s in value:gmatch('%d+') do
        table.insert(components, tonumber(s))
    end

    if #components == 3 then
        fromColor = Color3.new(
            math.clamp(components[1] / 255, 0, 1),
            math.clamp(components[2] / 255, 0, 1),
            math.clamp(components[3] / 255, 0, 1)
        )
        if isCustomColorMode then
            stopRainbowEffect()
            RBW_COL = fromColor
            customColorStep = 0
            wait(0.5) -- Wait for a moment before starting the transition
            startRainbowEffect()
        end
    end
end)

local toColorTextbox = Section.Newtextbox('To Color (R,G,B)', function(self, value)
    local components = {}
    for s in value:gmatch('%d+') do
        table.insert(components, tonumber(s))
    end

    if #components == 3 then
        toColor = Color3.new(
            math.clamp(components[1] / 255, 0, 1),
            math.clamp(components[2] / 255, 0, 1),
            math.clamp(components[3] / 255, 0, 1)
        )
        if isCustomColorMode then
            stopRainbowEffect()
            customColorStep = 0
            wait(0.5) -- Wait for a moment before starting the transition
            startRainbowEffect()
        end
    end
end)

-- Add 6 textboxes for custom colors
local customColorTextboxes = {}
for i = 1, 6 do
    customColorTextboxes[i] = Section.Newtextbox('Custom Color ' .. i .. ' (R,G,B)', function(self, value)
        local components = {}
        for s in value:gmatch('%d+') do
            table.insert(components, tonumber(s))
        end

        if #components == 3 then
            customColors[i] = Color3.new(
                math.clamp(components[1] / 255, 0, 1),
                math.clamp(components[2] / 255, 0, 1),
                math.clamp(components[3] / 255, 0, 1)
            )
            if isCustomColorMode then
                stopRainbowEffect()
                customColorStep = 0
                wait(0.5) -- Wait for a moment before starting the transition
                startRainbowEffect()
            end
        end
    end)
end

spawn(randomizeRainbowSpeed) -- Start the function in a separate thread to run concurrently
